!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/forms"),require("rxjs"),require("@angular/animations"),require("@angular/platform-browser/animations"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-input-msg",["exports","@angular/core","@angular/forms","rxjs","@angular/animations","@angular/platform-browser/animations","@angular/common"],e):e(t["ngx-input-msg"]={},t.ng.core,t.ng.forms,t.rxjs,t.ng.animations,t.ng.platformBrowser.animations,t.ng.common)}(this,function(t,e,n,i,r,a,o){"use strict";var s=function(){function t(){this.defaultConfig={colors:{error:"#f44336",maxlength:"grey"},position:"bottom-left",msg:{email:function(t){return"Wrong "+t},integer:"Fractional digits are forbidden",max:function(t,e){return"Maximum allowed "+t+" is "+e},min:function(t,e){return"Minimum allowed "+t+" is "+e},maxlength:function(t,e){return"Maximum "+e+" chars limit was reached"},minlength:function(t,e){return"At least "+e+" chars length are required"},pattern:function(t){return"Invalid "+t},required:function(t){return t+" is required"}}}}return t.prototype.get=function(){return this.defaultConfig},t.prototype.set=function(e){var n=this;e.position&&(this.defaultConfig.position=e.position),e.colors&&Object.keys(e.colors).forEach(function(t){n.defaultConfig.colors[t]=e.colors[t]}),e.msg&&Object.keys(e.msg).forEach(function(t){n.defaultConfig.msg[t]=e.msg[t]})},t.decorators=[{type:e.Injectable}],t}(),u=function(){function t(){this.storageById={},this.storageByName={}}return t.prototype.get=function(t){return this.storageById[t]||this.storageByName[t]},t.prototype.remove=function(t){this.removeFromSpecificStorage("storageById",t),this.removeFromSpecificStorage("storageByName",t)},t.prototype.set=function(t,e,n){e&&(this.storageById[e]=t),n&&(this.storageByName[n]=t)},t.prototype.removeFromSpecificStorage=function(t,e){this[t][e]&&delete this[t][e]},t.decorators=[{type:e.Injectable}],t}(),l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};function p(t,e){function n(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function c(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}var m=function(){function t(t,e,n){this.elemRef=t,this.inputStorageService=e,this.inputValidatorFactory=n,this.statusSubscriptions=[]}return t.prototype.ngOnChanges=function(e){var n=this,i={placeholder:!0,label:!0,required:!0};Object.keys(e).forEach(function(t){if(i[t]&&n.validatorOptions[t]&&!e[t].isFirstChange()){if("placeholder"===t||"label"===t)return n.inputParams.label=e[t].currentValue,void n.inputParams.paramChange.next("label");n.setValidationParams(),n.inputParams.paramChange.next(t),n.createValidator(),n.model.control.updateValueAndValidity()}})},t.prototype.ngOnDestroy=function(){this.statusOff(),this.inputStorageService.remove(this.inputKey)},t.prototype.ngOnInit=function(){var t=this;this.elem=this.elemRef.nativeElement,this.isMaterial=""===this.matInput,this.inputKey=this.id||this.name,this.checkRequiredParams(),this.setMatFormFieldClass(),this.initInputParams(),this.setValidationParams(),this.createValidator(),this.inputStorageService.set(this.inputParams,this.id,this.name),setTimeout(function(){if(t.form=t.model.formDirective,!t.form)throw new Error('ngxInput directive: the element with name="'+t.name+'" have to be inside a <form> element');t.statusOn()},0)},t.prototype.validate=function(t){return this.validator.validate(t)},t.prototype.hasBoolaenParam=function(t){return""===this[t]||!0===this[t]},t.prototype.hasNumberParam=function(t){return!isNaN(this[t])&&isFinite(this[t])},t.prototype.checkRequiredParams=function(){if(!this.name)throw new Error("ngxInput directive: can't find name attribute on the element");if(!(this.model instanceof n.NgModel))throw new Error("ngxInput directive: NgModel instance have to be provided to [model] param of the element")},t.prototype.createValidator=function(){var e={};this.validatorParams.forEach(function(t){e[t.name]=t}),this.validator=this.inputValidatorFactory.create(e)},t.prototype.initInputParams=function(){this.inputParams={label:this.placeholder||this.label,material:this.isMaterial,paramChange:new i.Subject,status:new i.BehaviorSubject("pristine"),valid:new i.BehaviorSubject(!0),validationParams:undefined}},t.prototype.setMatFormFieldClass=function(){if(this.isMaterial){for(var t=this.elemRef.nativeElement.parentElement,e=0;e<10&&"MAT-FORM-FIELD"!==t.tagName;e++)if(t=t.parentElement,9===e)throw new Error("ngxInput directive: Can't find parent <mat-form-field> elem");t.classList.add("ngx-msg__mat-form-field")}},t.prototype.setValidationParams=function(){var n=this;if(this.inputParams.validationParams={},this.validatorParams=[],this.hasBoolaenParam("required")){var t={name:"required",value:undefined,set:!0};this.inputParams.validationParams.required=t,this.validatorParams.push(t)}Object.keys(this.validatorOptions).forEach(function(t){var e=n.validatorOptions[t]();e.set&&(n.inputParams.validationParams[t]=e,n.validatorParams.push(e))})},t.prototype.statusOff=function(){this.statusSubscriptions.forEach(function(t){t.unsubscribe()})},t.prototype.statusOn=function(){var t,e,n,o=this,i=function(){try{for(var t=c(o.validatorParams),e=t.next();!e.done;e=t.next()){var n=e.value;if(o.model.hasError(n.name))return o.inputParams.valid.next(!1),void o.inputParams.status.next(n.name)}}catch(a){i={error:a}}finally{try{e&&!e.done&&(r=t["return"])&&r.call(t)}finally{if(i)throw i.error}}var i,r},r=function(){(o.model.touched||o.form.submitted)&&i()},a=(t=this.elem,e="blur",n=r,t.addEventListener(e,n),{unsubscribe:function(){t.removeEventListener(e,n)}});this.statusSubscriptions.push(a);var s=this.model.valueChanges.subscribe(r);this.statusSubscriptions.push(s);var u=this.form.ngSubmit.subscribe(i);this.statusSubscriptions.push(u);var l=this.model.statusChanges.subscribe(function(t){switch(t){case"INVALID":o.prevValid=!1;break;case"VALID":o.prevValid||(o.inputParams.valid.next(!0),o.inputParams.status.next("valid")),o.prevValid=!0;break;case"PRISTINE":o.inputParams.valid.next(!0),o.inputParams.status.next("pristine");break;default:return}});this.statusSubscriptions.push(l);var p=this.inputParams.valid.subscribe(function(t){t?o.elem.classList.remove("ngx-input_invalid"):o.elem.classList.add("ngx-input_invalid")});this.statusSubscriptions.push(p)},t.propDecorators={id:[{type:e.Input}],label:[{type:e.Input}],matInput:[{type:e.Input}],model:[{type:e.Input}],name:[{type:e.Input}],placeholder:[{type:e.Input}],required:[{type:e.Input}]},t}(),h=function(){function t(){}return t.prototype.validate=function(t){var e,n,i=null;try{for(var r=c(this.currentValidators),a=r.next();!a.done;a=r.next()){var o=a.value;if(null!==(i=o.fn(t.value,o.value)))break}}catch(s){e={error:s}}finally{try{a&&!a.done&&(n=r["return"])&&n.call(r)}finally{if(e)throw e.error}}return i},t.prototype.empty=function(t){return void 0===t||""===t||null===t},t.prototype.setCurrentValidators=function(t){var n=this;if("object"!=typeof this.availableValidators)throw new Error("InputValidator class: this.availableValidators have to be initialized in the derived class");if(!Array.isArray(this.validatorSequence))throw new Error("InputValidator class: this.validatorSequence have to be initialized in the derived class");this.availableValidators.required=this.required.bind(this),this.currentValidators=[],this.getValidatorParamSequence(t).forEach(function(t){var e={name:t.name,value:t.value,set:t.set,fn:n.availableValidators[t.name]};n.currentValidators.push(e)})},t.prototype.getValidatorParamSequence=function(e){var n=[];return this.validatorSequence.forEach(function(t){e[t]&&n.push(e[t])}),n},t.prototype.required=function(t){return this.empty(t)?{required:!0}:null},t}(),g=function(n){function t(t){var e=n.call(this)||this;return e.validatorsToApply=t,e.availableValidators={email:e.email},e.validatorSequence=["required","email"],n.prototype.setCurrentValidators.call(e,t),e}return p(t,n),t.prototype.email=function(t){if(n.prototype.empty.call(this,t))return{email:null};return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)?null:{email:t}},t}(h),f=function(){function t(){}return t.prototype.create=function(t){return new g(t)},t.decorators=[{type:e.Injectable}],t}(),d=function(r){function t(t,e,n){var i=r.call(this,t,e,n)||this;return i.elemRef=t,i.inputStorageService=e,i.validatorFactory=n,i.validatorOptions={email:function(){return{name:"email",set:!0}}},i}return p(t,r),t.decorators=[{type:e.Directive,args:[{selector:"input[ngxInputEmail]",providers:[{provide:n.NG_VALIDATORS,useExisting:t,multi:!0},f]}]}],t.ctorParameters=function(){return[{type:e.ElementRef},{type:u},{type:f}]},t}(m),y=function(n){function t(t){var e=n.call(this)||this;return e.validatorsToApply=t,e.availableValidators={integer:e.integer.bind(e),max:e.max.bind(e),min:e.min.bind(e)},e.validatorSequence=["required","integer","min","max"],n.prototype.setCurrentValidators.call(e,t),e}return p(t,n),t.prototype.integer=function(t){return this.number(t)?Math.floor(t)===t?null:{integer:t}:{integer:"Not a number"}},t.prototype.max=function(t,e){return this.number(t)?e<t?{max:0===t?"0":t}:null:{max:"Not a number"}},t.prototype.min=function(t,e){return this.number(t)?t<e?{min:0===t?"0":t}:null:{min:"Not a number"}},t.prototype.number=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},t}(h),v=function(){function t(){}return t.prototype.create=function(t){return new y(t)},t.decorators=[{type:e.Injectable}],t}(),b=function(r){function t(t,e,n){var i=r.call(this,t,e,n)||this;return i.elemRef=t,i.inputStorageService=e,i.validatorFactory=n,i.validatorOptions={integer:function(){return{name:"integer",set:r.prototype.hasBoolaenParam.call(i,"integer")}},max:function(){return{name:"max",set:r.prototype.hasNumberParam.call(i,"max"),value:+i.max}},min:function(){return{name:"min",set:r.prototype.hasNumberParam.call(i,"min"),value:+i.min}}},i}return p(t,r),t.decorators=[{type:e.Directive,args:[{selector:'input[ngxInputNumber][type="number"]',providers:[{provide:n.NG_VALIDATORS,useExisting:t,multi:!0},v]}]}],t.ctorParameters=function(){return[{type:e.ElementRef},{type:u},{type:v}]},t.propDecorators={integer:[{type:e.Input}],max:[{type:e.Input}],min:[{type:e.Input}]},t}(m),x=function(n){function t(t){var e=n.call(this)||this;return e.validatorsToApply=t,e.availableValidators={maxlength:e.maxlength,minlength:e.minlength,pattern:e.pattern},e.validatorSequence=["required","minlength","maxlength","pattern"],n.prototype.setCurrentValidators.call(e,t),e}return p(t,n),t.prototype.maxlength=function(t,e){return n.prototype.empty.call(this,t)?null:t.length>e?{maxlength:t}:null},t.prototype.minlength=function(t,e){return null==t?null:""===t?{minlength:"empty"}:t.length<e?{minlength:t}:null},t.prototype.pattern=function(t,e){return n.prototype.empty.call(this,t)?{pattern:"empty"}:e.test(t)?null:{pattern:t}},t}(h),S=function(){function t(){}return t.prototype.create=function(t){return new x(t)},t.decorators=[{type:e.Injectable}],t}(),I=function(r){function t(t,e,n){var i=r.call(this,t,e,n)||this;return i.elemRef=t,i.inputStorageService=e,i.validatorFactory=n,i.validatorOptions={maxlength:function(){return{name:"maxlength",set:r.prototype.hasNumberParam.call(i,"maxlength"),value:+i.maxlength}},minlength:function(){return{name:"minlength",set:r.prototype.hasNumberParam.call(i,"minlength"),value:+i.minlength}},pattern:function(){return{name:"pattern",set:i.pattern instanceof RegExp,value:i.pattern}}},i}return p(t,r),t.prototype.ngOnChanges=function(t){r.prototype.ngOnChanges.call(this,t),this.maxLengthOn()},t.prototype.ngOnDestroy=function(){r.prototype.ngOnDestroy.call(this),this.maxLengthOff()},t.prototype.ngOnInit=function(){r.prototype.ngOnInit.call(this),this.maxLengthOn()},t.prototype.emitMaxLengthStatus=function(){this.model.value.length===+this.maxlength&&this.inputParams.status.next("maxlength")},t.prototype.maxLengthOff=function(){this.maxLengthSub&&this.maxLengthSub.unsubscribe()},t.prototype.maxLengthOn=function(){r.prototype.hasNumberParam.call(this,"maxlength")&&!this.maxLengthSub&&(this.maxLengthSub=this.model.valueChanges.subscribe(this.emitMaxLengthStatus.bind(this)))},t.decorators=[{type:e.Directive,args:[{selector:"input[ngxInputText], textarea[ngxInputText]",providers:[{provide:n.NG_VALIDATORS,useExisting:t,multi:!0},S]}]}],t.ctorParameters=function(){return[{type:e.ElementRef},{type:u},{type:S}]},t.propDecorators={maxlength:[{type:e.Input}],minlength:[{type:e.Input}],pattern:[{type:e.Input}]},t}(m),P=function(){function t(t,e,n){this.configService=t,this.elemRef=e,this.inputStorageService=n}return t.prototype.ngOnDestroy=function(){this.valid&&this.valid.unsubscribe&&this.valid.unsubscribe()},t.prototype.ngOnInit=function(){var e=this;if(this.elem=this.elemRef.nativeElement,this.highlightColor=this.configService.get().colors.error,!this["for"])throw new Error("ngxLabel directive: 'for' attribute with input id or name is required.");this.setAnimation(),setTimeout(function(){var t=e.inputStorageService.get(e["for"]);if(!t)throw new Error("ngxLabel directive: can't find the input element with id or name: "+e["for"]);e.valid=t.valid,e.valid.subscribe(function(t){e.toggleClassOnValidChange(t),e.highlightOnValidChange(t)})},0)},t.prototype.highlightOnValidChange=function(t){this.elem.style.color=t?"":this.highlightColor},t.prototype.setAnimation=function(){this.elem.style.transition="color 250ms ease-in"},t.prototype.toggleClassOnValidChange=function(t){t?this.elem.classList.remove("ngx-input_invalid"):this.elem.classList.add("ngx-input_invalid")},t.decorators=[{type:e.Directive,args:[{selector:"[ngxLabel]"}]}],t.ctorParameters=function(){return[{type:s},{type:e.ElementRef},{type:u}]},t.propDecorators={"for":[{type:e.Input}]},t}(),C=function(){function t(t,e){this.configService=t,this.storageService=e,this.messages={},this.subscriptions=[]}return t.prototype.getClasses=function(){var t=this.position||this.configService.get().position;return{"ngx-msg_pos_bottom-left":"bottom-left"===t,"ngx-msg_pos_bottom-right":"bottom-right"===t,"ngx-msg_color_tooltip":"maxlength"===this.currentStatus,"ngx-msg_material":this.inputParams.material}},t.prototype.getStyles=function(){return{color:"maxlength"===this.currentStatus?this.defaultConfig.colors.maxlength:this.defaultConfig.colors.error}},t.prototype.ngOnChanges=function(e){var n=this,i={email:!0,integer:!0,max:!0,maxlength:!0,min:!0,minlength:!0,position:!0,required:!0};Object.keys(e).forEach(function(t){i[t]&&!e[t].isFirstChange()&&(n.setMessage(t),n.currentStatus===t&&"maxlength"!==t&&(n.currentMsg=n.messages[t]))})},t.prototype.ngOnDestroy=function(){this.subscriptions.forEach(function(t){return t.unsubscribe()})},t.prototype.ngOnInit=function(){if(this.defaultConfig=this.configService.get(),!this["for"])throw new Error("ngxMsg component: 'for' parameter with the input id or name must be provided.");if(this.inputParams=this.storageService.get(this["for"]),!this.inputParams)throw new Error("ngxMsg component: can't find the input element with id or name: "+this["for"]);this.setAllMessages();var t=this.inputParams.status.subscribe(this.onStatusChange.bind(this));this.subscriptions.push(t);var e=this.inputParams.paramChange.subscribe(this.onInputParamsChange.bind(this));this.subscriptions.push(e)},t.prototype.onInputParamsChange=function(t){"label"===t?this.setAllMessages():this.setMessage(t),"pristine"!==this.currentStatus&&"valid"!==this.currentStatus&&"maxlength"!==this.currentStatus&&(this.currentMsg=this.messages[this.currentStatus])},t.prototype.onStatusChange=function(t){var e=this;switch(this.currentStatus=t){case"pristine":case"valid":this.currentMsg="";break;case"maxlength":this.currentMsg=this.messages[t],setTimeout(function(){e.currentMsg=""},2e3);break;default:this.currentMsg=this.messages[t]}},t.prototype.setAllMessages=function(){var e=this;Object.keys(this.inputParams.validationParams).forEach(function(t){e.setMessage(t)})},t.prototype.setMessage=function(t){if(this.inputParams.validationParams[t]){var e,n;e="undefined"!=typeof this[t]?this[t]:this.defaultConfig.msg[t],n=e,this.messages[t]="function"==typeof n?e(this.inputParams.label,this.inputParams.validationParams[t].value):e}},t.decorators=[{type:e.Component,args:[{selector:"ngx-msg",template:'<div class="ngx-msg__container" \n  [ngClass]="getClasses()"\n  [ngStyle]="getStyles()"\n  >\n\n  <span *ngIf="currentMsg" [@msgAnimation]>\n    {{currentMsg}}\n  </span>\n\n</div>\n',styles:[".ngx-msg__mat-form-field{margin-bottom:16px;width:100%}.ngx-msg__container{display:block;font-size:12px;min-height:20px;margin-top:3px}.ngx-msg_material{margin-top:-33px}.ngx-msg_pos_bottom-left{text-align:left}.ngx-msg_pos_bottom-right{text-align:right}"],encapsulation:e.ViewEncapsulation.None,animations:[r.trigger("msgAnimation",[r.state("active",r.style({opacity:1})),r.transition("void => *",[r.style({opacity:0}),r.animate("250ms ease-in",r.style({opacity:1}))]),r.transition("* => void",[r.style({opacity:1}),r.animate("250ms ease-in",r.style({opacity:0}))])])]}]}],t.ctorParameters=function(){return[{type:s},{type:u}]},t.propDecorators={"for":[{type:e.Input}],email:[{type:e.Input}],integer:[{type:e.Input}],max:[{type:e.Input}],maxlength:[{type:e.Input}],min:[{type:e.Input}],minlength:[{type:e.Input}],pattern:[{type:e.Input}],position:[{type:e.Input}],required:[{type:e.Input}]},t}(),O=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[a.BrowserAnimationsModule,o.CommonModule,n.FormsModule],declarations:[d,b,I,P,C],providers:[s,u],exports:[d,b,I,P,C]}]}],t}();t.InputMsgConfigService=s,t.InputStorageService=u,t.InputEmailDirective=d,t.InputNumberDirective=b,t.InputTextDirective=I,t.LabelDirective=P,t.MsgComponent=C,t.InputMsgModule=O,t.ɵc=f,t.ɵd=v,t.ɵe=S,t.ɵa=m,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-input-msg.umd.min.js.map